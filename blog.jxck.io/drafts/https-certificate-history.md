# [https][ca] 近代 HTTPS 証明書略史

## Intro

今では当たり前になった HTTPS 化の波は、ここ数年に急激に広まったものだ。

その裏では、社会の情勢の変化や、その変化が起こったきっかけとなるインシデント、そしてそれを塞ぐための努力があった。

そろそろ記憶に頼るのが難しくなったので、忘れないうちに一度まとめておく。


## HTTP 黎明期

かつて、Web は平文の HTTP でデプロイされるのが普通だった。

今でも変わらずデプロイを続けているサービスは少ないが、代表例として以下がある。

おそらくこのサイトは可能な限りデプロイされ続けるので、HTTP でアクセスできるサンプルサイトとして覚えておくと何かと便利だ。

http://example.com

通信が平文であるということは、盗聴も改ざんもなりすましも、やりたい放題だった。インターネットの黎明期は、社会生活のインターネット依存度も低く、通信も有線が通常だったため、発生するインシデントは今よりも少なかったかもしれない。

しかし、発覚してないだけの攻撃は、想像を絶するほど発生していた可能性が頭をよぎる。

良くも悪くも牧歌的だった時代だ。


## HTTPS の黎明期

Netscape が SSL を実装し、徐々に暗号化自体が普及し、証明書を取得して HTTPS でデプロイするサイトも出始めた。

これは、人々の生活がインターネットに依存し始め、例えば金融サービスなどを使うようになったという情勢の変化や、WiFi が出てき始めるという環境の変化もあるだろう。

仕様も標準化され TLS/2.0 あたりまで整備されても、まだ HTTPS は必須ではなく、導入するサイトも「パスワードを入力するログイン画面だけ HTTPS にする」といった、今から考えれば片手落ちな実装も多くあった。

このころは証明書取得も、メールで業者とやり取りして手動で発行され、値段もまあまあかかった。デプロイにも手をいれる必要があり、証明書更新などの運用も整備する必要がある。要するにコストが高く、そのしわ寄せは、「このサイトは特に重要な情報が無いので、HTTPS 化する必要はない」といった判断につながっていた。

逆に EV 証明書に対応していれば、それは「他よりも安全」という印とみなされ、「偽サイトかどうかは URL バーの緑の部分に組織名が出ているかを確認する」というリテラシー教育も通用していた。


## スノーデン事件

HTTPS 化の必要性を説く人は一定数おり、資金に余裕があれば HTTPS 化するサイトもあったが、必ずしも全てのサイトがそうだったわけではない。特に、収益化してないサイトがわざわざ証明書を買ったりしない。

どこかで「盗聴は個人的な攻撃者による標的型攻撃」だという前提もあったように思う。Alice と Bob の間で盗み聞きする Eve は、パスワードの窃取や改ざんなど、なにか目的をもって狙っているはず、という前提だ。

しかし、2013 年にスノーデンのリークによって発覚した Prism 計画は、Eve が国家であり、広く国民の通信を盗聴していた、という想像はできても想定はしてなかった事実を明るみにした。

もはや「このサイトには個人情報が無いから」などと選んではいられない。それが Wiki や誰かの Blog のように、誰が見ても同じコンテンツで個人情報なんか預けてないとしても、通信の履歴をつぶさに追いかければ、そこに蓄積された属性情報から推察されるユーザ像は、かなり鮮明なものになる。

これは、プライバシーの観点からは、「全てのサイトは暗号化されなければならない」という方向に動いたおおきなきっかけだった。