<!DOCTYPE html>
<html amp lang=ja>
<head>
  <meta charset=utf-8>
  <meta name=viewport content="width=device-width,initial-scale=1">

  <link rel=author    href=https://jxck.io/humans.txt>
  <link rel=manifest  href=/manifest.webmanifest>
  <link rel=alternate href=/feeds/atom.xml type=application/atom+xml title=blog.jxck.io>

  <link rel=canonical href=https://blog.jxck.io/entries/2016-04-09/public-key-pinning.html>

  <link rel=icon             type =image/svg+xml sizes=any href=https://jxck.io/assets/img/jxck.svg>
  <link rel=icon             type =image/png sizes=256x256 href=https://jxck.io/assets/img/jxck.png>
  <link rel=apple-touch-icon type =image/png sizes=256x256 href=https://jxck.io/assets/img/jxck.png>

  <meta name=author              content=Jxck>
  <meta name=description         content="æœ¬ã‚µã‚¤ãƒˆã«ã¦ Public Key Pinning for HTTP ã‚’æœ‰åŠ¹åŒ–ã—ãŸã€‚CSP åŒæ§˜ã€ã¾ãšã¯ Report-Only ã‚’è¨­å®šã—ã€HPKP Report ã«ã¤ã„ã¦ã‚‚ã€ report-uri.io ã‚’ç”¨ã„ã¦åé›†ã™ã‚‹ã“ã¨ã«ã—ãŸã€‚å°å…¥ã«å¿…è¦ãªè¨­å®šã‚„ã€æ³¨æ„ç‚¹ã«ã¤ã„ã¦ã¾ã¨ã‚...">
  <meta name=keywords            content="hpkp,security">
  <meta name=theme-color         content=#000000>

  <meta name=twitter:card        content=summary>
  <meta name=twitter:site        content=@jxck_>
  <meta name=twitter:url         content=https://blog.jxck.io/entries/2016-04-09/public-key-pinning.html>
  <meta name=twitter:title       content="Public Key Pinning for HTTP(HPKP) å¯¾å¿œã¨ report-uri.io ã§ã®ãƒ¬ãƒãƒ¼ãƒˆåé›† | blog.jxck.io">
  <meta name=twitter:description content="æœ¬ã‚µã‚¤ãƒˆã«ã¦ Public Key Pinning for HTTP ã‚’æœ‰åŠ¹åŒ–ã—ãŸã€‚CSP åŒæ§˜ã€ã¾ãšã¯ Report-Only ã‚’è¨­å®šã—ã€HPKP Report ã«ã¤ã„ã¦ã‚‚ã€ report-uri.io ã‚’ç”¨ã„ã¦åé›†ã™ã‚‹ã“ã¨ã«ã—ãŸã€‚å°å…¥ã«å¿…è¦ãªè¨­å®šã‚„ã€æ³¨æ„ç‚¹ã«ã¤ã„ã¦ã¾ã¨ã‚...">
  <meta name=twitter:image       content=https://jxck.io/assets/img/jxck.png>

  <meta property=og:type         content=article>
  <meta property=og:url          content=https://blog.jxck.io/entries/2016-04-09/public-key-pinning.html>
  <meta property=og:title        content="Public Key Pinning for HTTP(HPKP) å¯¾å¿œã¨ report-uri.io ã§ã®ãƒ¬ãƒãƒ¼ãƒˆåé›† | blog.jxck.io">
  <meta property=og:site_name    content=blog.jxck.io>
  <meta property=og:description  content="æœ¬ã‚µã‚¤ãƒˆã«ã¦ Public Key Pinning for HTTP ã‚’æœ‰åŠ¹åŒ–ã—ãŸã€‚CSP åŒæ§˜ã€ã¾ãšã¯ Report-Only ã‚’è¨­å®šã—ã€HPKP Report ã«ã¤ã„ã¦ã‚‚ã€ report-uri.io ã‚’ç”¨ã„ã¦åé›†ã™ã‚‹ã“ã¨ã«ã—ãŸã€‚å°å…¥ã«å¿…è¦ãªè¨­å®šã‚„ã€æ³¨æ„ç‚¹ã«ã¤ã„ã¦ã¾ã¨ã‚...">
  <meta property=og:image        content=https://jxck.io/assets/img/jxck.png>

  <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage":{
      "@type":"WebPage",
      "@id":"https://blog.jxck.io"
    },
    "headline": "Public Key Pinning for HTTP(HPKP) å¯¾å¿œã¨ report-uri.io ã§ã®ãƒ¬ãƒãƒ¼ãƒˆåé›† | blog.jxck.io",
    "image": [
      "https://jxck.io/assets/img/jxck.png",
      "https://logo.jxck.io/jxck.1200x1200.png"
    ],
    "datePublished": "2016-04-09T08:00:00+08:00",
    "dateModified": "2020-12-18T08:00:00+08:00",
    "author": {
      "@type": "Person",
      "name": "Jxck",
      "image": "https://jxck.io/assets/img/jxck.png"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Jxck",
      "logo": {
        "@type": "ImageObject",
        "url": "https://logo.jxck.io/jxck.60x60.png",
        "height": 60,
        "width": 60
      }
    },
    "description": "æœ¬ã‚µã‚¤ãƒˆã«ã¦ Public Key Pinning for HTTP ã‚’æœ‰åŠ¹åŒ–ã—ãŸã€‚CSP åŒæ§˜ã€ã¾ãšã¯ Report-Only ã‚’è¨­å®šã—ã€HPKP Report ã«ã¤ã„ã¦ã‚‚ã€ report-uri.io ã‚’ç”¨ã„ã¦åé›†ã™ã‚‹ã“ã¨ã«ã—ãŸã€‚å°å…¥ã«å¿…è¦ãªè¨­å®šã‚„ã€æ³¨æ„ç‚¹ã«ã¤ã„ã¦ã¾ã¨ã‚..."
  }
  </script>

  <title>Public Key Pinning for HTTP(HPKP) å¯¾å¿œã¨ report-uri.io ã§ã®ãƒ¬ãƒãƒ¼ãƒˆåé›† | blog.jxck.io</title>
  <script async custom-element=amp-analytics src=https://cdn.ampproject.org/v0/amp-analytics-0.1.js></script>
  <script async custom-element=amp-iframe src=https://cdn.ampproject.org/v0/amp-iframe-0.1.js></script>
  <script async custom-element=amp-ad src=https://cdn.ampproject.org/v0/amp-ad-0.1.js></script>
  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
  <script async src=https://cdn.ampproject.org/v0.js></script>
  <style amp-custom>
    article section p {
      margin-inline-start: 0;
    }

    article table {
      margin-inline-start: 0;
    }

    article img {
      margin-block-start:  var(--grid);
      margin-block-end:    var(--grid);
      margin-inline-start: 0;
      margin-inline-end:   0;
      border: 1px solid #ccc;
      box-sizing: content-box;
      background-color: #fff;
    }

    article ul,
    article ol,
    article dl {
      margin-inline-start: var(--grid);
      font-family: var(--mono-font);
    }

    article li {
      margin-block-start:  calc(var(--grid)/2);
      margin-block-end:    0;
      margin-inline-start: calc(var(--grid)/2);
      margin-inline-end:   0;
    }

    article dl {
      display: grid;
      grid-template-columns: minmax(auto, max-content);
      grid-column-gap: var(--grid);
    }

    article dl div {
      display: contents;
    }

    article dl dt {
      grid-column: 1 / 2;
    }
    article dl dd {
      grid-column: 2 / 2;
    }

    article blockquote {
      font-family: var(--mono-font);
    }

    article blockquote p {
      margin: 0;
    }

    @supports (line-height-step: 1px) {
      article {
        --grid-rhythm: 1.5em;
        line-height: 1.5;
        line-height-step: var(--grid-rhythm);
      }

      article h1,
      article h2,
      article h3,
      article h4,
      article h5,
      article h6 {
        display: inline-block;
        width: 100%;
        line-height-step: 0;
        line-height: 1.2;
        margin-block-end: 0;
      }

      article section {
        /* grid for debug */
        /* background-size: 100% var(--grid-rhythm); */
        /* background-image: linear-gradient(to bottom, #00bcd1 1px, transparent 1px); */
      }

      article p {
        margin-block-start: var(--grid-rhythm);
        margin-block-end:   var(--grid-rhythm);
      }

      article pre,
      article table {
        line-height-step: 0;
        line-height: normal;
      }
    }
    /* normal regular */
    @font-face {
      font-family: "NotoSansCJKjp-Jxck";
      font-style: normal;
      font-weight: 400;
      font-display: swap;
      src:
        local("Noto Sans CJK JP Regular"),
        url("/assets/font/NotoSansCJKjp-Regular-Jxck-20201215.woff2") format("woff2");
    }
    /* normal bold */
    @font-face {
      font-family: "NotoSansCJKjp-Jxck";
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src:
        local("Noto Sans CJK JP Bold"),
        url("/assets/font/NotoSansCJKjp-Bold-Jxck-20201215.woff2") format("woff2");
    }


    /* mono regular */
    @font-face {
      font-family: "NotoSansMonoCJKjp-Jxck";
      font-style: normal;
      font-weight: 400;
      font-display: swap;
      src:
        local("Noto Sans Mono CJK JP Regular"),
        url("/assets/font/NotoSansMonoCJKjp-Regular-Jxck-20201215.woff2") format("woff2");
    }
    /* mono bold */
    @font-face {
      font-family: "NotoSansMonoCJKjp-Jxck";
      font-style: normal;
      font-weight: 700;
      font-display: swap;
      src:
        local("Noto Sans Mono CJK JP Bold"),
        url("/assets/font/NotoSansMonoCJKjp-Bold-Jxck-20201215.woff2") format("woff2");
    }

    /* Light Mode Theme */
    :root {
      --background-color: #fefefe;
      --font-color: #222;
      --header-color: #222;

      --anchor-color: RoyalBlue;
      --anchor-visited-color: Brown;

      /*--code-block: #161b22;*/
      --code-block: #182331;
      --code-block-font: #cad6e4;

      --code-inline: #f1f5f9;
      --code-inline-font: #292929;

      --block-quote: #ddd;
      --table-border: #222;

      --regular-font: "Noto Sans", "Noto Sans CJK JP", "NotoSansCJKjp-Jxck", "Hiragino Sans", 'ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ Pro W3', 'ãƒ¡ã‚¤ãƒªã‚ª', sans-serif;
      --mono-font: Menlo, Consolas, Liberation, Mono, Courier, "NotoSansMonoCJKjp-Jxck";
      --code-font: Menlo, Consolas, Liberation, Mono, Courier, "NotoSansMonoCJKjp-Jxck";

      --icon-size: 30px;

      --width: 80vw;
      --max-width: 1024px;

      --grid: 1rem;

      --radius: 4px;
    }


    /* Mobile Theme */
    @media screen and (max-device-width: 960px) {
      :root {
        --width: 94vw;
      }

      audio {
        width: 100%;
      }
    }

    /* Dark Mode Theme */
    @media (prefers-color-scheme: dark) {
      :root {
        --header-color: #111;
        --background-color: #222;
        --font-color: #eee;

        --anchor-color: CornflowerBlue;
        --anchor-visited-color: RosyBrown;

        --table-border: #eee;
      }

      article img {
        filter: grayscale(50%);
      }
      article img[src*=svg] {
        filter: invert(100%) grayscale(50%);
      }
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--regular-font);
      background-color: var(--background-color);
      color: var(--font-color);
      font-feature-settings: "palt";
      margin: 0;
      padding: 0;
    }

    code {
      font-family: var(--mono-font);
    }

    img {
      max-width: 100%;
      height: auto;
    }

    hr {
      margin: 0;
      padding: 0;
    }

    iframe {
      display: block;
      max-width: 100%;
      margin-block-start:  var(--grid);
      margin-block-end:    var(--grid);
      margin-inline-start: 0;
      margin-inline-end:   0;
    }
    dl.info {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      margin: 0;
      padding: 0;
    }

    dl.info div {
      display: flex;
      flex-direction: row;
      flex-wrap: nowrap;
    }

    dl.info dt::after {
      content: ":";
      padding-inline-end: calc(var(--grid)/2);
    }

    dl.info dd {
      margin-block-start: 0;
      margin-block-end: 0;
      margin-inline-end: var(--grid);
      margin-inline-start: 0;
    }

    dl.info dd i {
      font-style: normal;
      padding-inline-end: calc(var(--grid)/3);
    }

    details.info > summary {
    }

    details.info ul {
      margin-block-start: 0;
      margin-inline-start: var(--grid);
    }

    nav.tags {
      display: inline;
    }

    .tags ul {
      display: inline-flex;
      margin: 0;
      padding: 0;
    }

    .tags li:before {
      content: none;
    }

    .tags li:first-child:before{
      content: "[ ";
    }

    .tags li:after {
      content: ",";
      padding-inline-end: 0.5rem;
    }

    .tags li:last-child:after {
      content: " ]";
    }
    header {
      z-index: 1;
      position: sticky;
      position: -webkit-sticky;
      top: 0;
      box-sizing: border-box;
      margin: 0;
      padding: calc(var(--grid)/2);
      background-color: var(--header-color);
    }

    h2:target,
    h3:target,
    h4:target,
    h5:target,
    h6:target {
      /* sticky header ã«åˆã‚ã›ã¦ link scroll ã‚’ãšã‚‰ã™ */
      margin-block-start:  calc((var(--icon-size) + var(--grid)) * -1);
      padding-block-start: calc((var(--icon-size) + var(--grid)));
    }

    header nav {
      width: var(--width);
      max-width: var(--max-width);
      margin-block-start:  0;
      margin-block-end:    0;
      margin-inline-start: auto;
      margin-inline-end:   auto;
    }

    header nav ul {
      width: 100%;
      display: flex;
      flex-direction: row;
      align-items: stretch;
      margin: 0;
    }

    header nav li {
      width:  var(--icon-size);
      height: var(--icon-size);
      padding: 0;
      margin-block-start:  0;
      margin-block-end:    0;
      margin-inline-start: var(--grid);
      margin-inline-end:   0;
    }

    header nav ul li a,
    header nav ul li button {
      display: block;
      width: var(--icon-size);
      height: var(--icon-size);
      padding: 0;
      margin: 0;
      border: none;
      background-color: var(--header-color);
    }

    header nav svg {
      fill: var(--background-color);
    }

    header nav ul li::before {
      content: none;
    }

    header nav ul li:first-child {
      flex-grow: 1;
      margin-inline-start: 0;
    }

    header nav .logo {
      border: 1px solid #fff;
      box-sizing: border-box;
    }
    h1 > a,
    h2 > a,
    h3 > a,
    h4 > a,
    h5 > a,
    h6 > a {
      color: var(--font-color);
    }

    h1 > a:visited,
    h2 > a:visited,
    h3 > a:visited,
    h4 > a:visited,
    h5 > a:visited,
    h6 > a:visited {
      color: var(--font-color);
    }

    h1 > a::before {
      content: "# ";
    }

    h2 > a::before {
      content: "## ";
    }

    h3 > a::before {
      content: "### ";
    }

    h4 > a::before {
      content: "#### ";
    }

    h1 > a:hover::before,
    h2 > a:hover::before,
    h3 > a:hover::before,
    h4 > a:hover::before,
    h5 > a:hover::before,
    h6 > a:hover::before {
      color: var(--anchor-visited-color);
    }

    em {
      font-weight: bold;
      font-style: normal;
    }

    em::before,
    em::after {
      content: "*";
    }

    strong {
      color: red;
    }

    strong::before,
    strong::after {
      content: "**";
    }

    ul li::before {
      content: "- ";
    }

    ol {
      counter-reset: list;
    }

    ol li::before {
      counter-increment: list;
      content: counter(list) ". ";
    }

    dl dt::after {
      content: ":";
    }

    blockquote {
      display: block;
      border: solid 1px var(--block-quote);
      border-radius: var(--radius);
      padding: 1rem;
      margin: 0;
    }

    blockquote p::before {
      content: "> ";
    }

    code {
      background-color: var(--code-inline);
      color: var(--code-inline-font);
      border-radius: var(--radius);
      padding: 0 4px;
    }

    code::before,
    code::after {
      content: "`";
    }
    main {
      display: block;
      width: var(--width);
      max-width: var(--max-width);
      margin-block-start:  1em;
      margin-block-end:    1em;
      margin-inline-start: auto;
      margin-inline-end:   auto;
    }

    a {
      word-wrap: break-word;
      text-decoration: none;
      color: var(--anchor-color);
    }

    a:visited {
      color: var(--anchor-visited-color);
    }

    ol,
    ul {
      list-style: none;
      padding-inline-start: 0;
    }

    li {
      word-break: break-all;
      word-wrap: break-word;
    }

    dl dt {
      font-weight: bold;
      margin: 0;
    }

    dl dd {
      margin: 0;
    }
    footer {
      padding: var(--grid);
    }

    footer strong,
    footer .copyright {
      font-style: italic;
      width: var(--width);
      max-width: var(--max-width);
      margin-block-start:  0;
      margin-block-end:    0;
      margin-inline-start: auto;
      margin-inline-end:   auto;
    }

    /* AdSense */
    footer ins {
      display: block;
      width: var(--width);
      max-width: var(--max-width);
      margin-block-start:  0;
      margin-block-end:    0;
      margin-inline-start: auto;
      margin-inline-end:   auto;
    }
    pre {
      margin-block-start:  var(--grid);
      margin-block-end:    var(--grid);
      margin-inline-start: 0;
      margin-inline-end:   0;
      border-radius: var(--radius);
    }

    pre code {
      background-color: var(--code-block);
      color: var(--code-block-font);
    }

    pre::before {
      font-family: var(--code-font);
      content: "```" attr(data-code) "\A";
      font-size: 0.8em;
    }

    pre::after {
      font-family: var(--code-font);
      z-index: -1;
      position: relative;
      top: -1em;
      content: "\A```";
      font-size: 0.8em;
    }

    pre > code {
      font-family: var(--code-font);
      overflow: auto;
      display: block;
      padding: 0.5rem;
      margin: 0;
    }

    pre > code::before,
    pre > code::after {
      content: none;
    }

    .hljs-keyword,
    .hljs-params {
      color: #ff407d;
    }

    .hljs-title {
      color: #b787ff;
    }

    .hljs-string,
    .hljs-regexp {
      color: #84a3ff;
    }

    .hljs-number,
    .hljs-literal {
      color: #03b5f1;
    }

    .hljs-built_in {
      color: #1ada03;
    }

    .hljs-comment {
      color: #96969c;
    }

    .hljs-tag {
      color: #ff429a;
    }

    .hljs-strong {
      font-weight: bold;
    }

    .hljs-attribute {
      font-weight: bold;
      color: #7b9dff;
    }

    .hljs-meta {
      color: #71a0ff;
    }

    .hljs-selector-id,
    .hljs-selector-class,
    .hljs-selector-pseudo {
      color: #a880ef;
    }

    .hljs-selector-tag {
      color: #17c103;
    }

    .hljs-subst {
      font-weight: bold;
    }

    .hljs-variable {
      color: #a71d5d;
    }

    .hljs-symbol {
      font-weight: bold;
    }


    .hljs-bullet {
    }

    /**.hljs,**/
    .hljs-doctag,
    .hljs-code,
    .hljs-addition,
    .hljs-template-variable,
    .hljs-link,
    .hljs-quote,
    .hljs-template-tag,
    .hljs-deletion,
    .hljs-meta-string,
    .hljs-emphasis {
      /** ğŸ™ğŸ™ğŸ™
       * if you find element applyed this style, that's a bug.
       * please tell me https://github.com/jxck/jxck.io/issues
       **/
      font-size: 100em;
    }


    /* PrismJS 1.23.0
    https://prismjs.com/download.html#themes=prism-okaidia&languages=markup+css+clike+javascript+bash+c+cpp+erlang+go+http+hpkp+hsts+json+plsql+ruby+shell-session+sql+yaml */
    /**
     * okaidia theme for JavaScript, CSS and HTML
     * Loosely based on Monokai textmate theme by http://www.monokai.nl/
     * @author ocodia
     */

    .token.comment,
    .token.prolog,
    .token.doctype,
    .token.cdata {
      color: #8292a2;
    }

    .token.punctuation {
      color: #f8f8f2;
    }

    .token.namespace {
      opacity: .7;
    }

    .token.property,
    .token.tag,
    .token.constant,
    .token.symbol,
    .token.deleted {
      color: #f92672;
    }

    .token.boolean,
    .token.number {
      color: #ae81ff;
    }

    .token.selector,
    .token.attr-name,
    .token.string,
    .token.char,
    .token.builtin,
    .token.inserted {
      color: #a6e22e;
    }

    .token.operator,
    .token.entity,
    .token.url,
    .language-css .token.string,
    .style .token.string,
    .token.variable {
      color: #f8f8f2;
    }

    .token.atrule,
    .token.attr-value,
    .token.function,
    .token.class-name {
      color: #e6db74;
    }

    .token.keyword {
      color: #66d9ef;
    }

    .token.regex,
    .token.important {
      color: #fd971f;
    }

    .token.important,
    .token.bold {
      font-weight: bold;
    }
    .token.italic {
      font-style: italic;
    }

    .token.entity {
      cursor: help;
    }
    table {
      font-family: var(--mono-font);
      border-spacing: 0 0.4rem;
      margin-block-start:  var(--grid);
      margin-block-end:    var(--grid);
      margin-inline-start: 0;
      margin-inline-end:   0;
    }

    th {
      border-inline-start: 2px solid var(--table-border);
      border-block-end:    2px dashed var(--table-border);
      padding-block-start:  0;
      padding-block-end:    calc(var(--grid)/2);
      padding-inline-start: var(--grid);
      padding-inline-end:   var(--grid);
    }

    td {
      padding-block-start:  calc(var(--grid)/2);
      padding-block-end:    calc(var(--grid)/2);
      padding-inline-start: var(--grid);
      padding-inline-end:   var(--grid);
      border-inline-start: 2px solid var(--table-border);
    }

    th:last-child,
    td:last-child {
      border-inline-end: 2px solid var(--table-border);
    }

    .align-center {
      text-align: center;
    }

    /** TODO: fixup html class */
    .align-left {
      text-align: start;
    }

    /** TODO: fixup html class */
    .align-right {
      text-align: end;
    }
  </style>
</head>
<body>
<header>
  <nav>
    <ul>
      <li><a href=https://blog.jxck.io      ><amp-img width=30 height=30 src=/assets/img/blog.svg   alt="blog logo" class=logo    ></a>
      <li><a href=/searches                 ><amp-img width=30 height=30 src=/assets/img/search.svg alt=search                    ></a>
      <li><a href=.                         ><amp-img width=30 height=30 src=/assets/img/up.svg     alt="move to parent directory"></a>
      <li><a href=/feeds/atom.xml           ><amp-img width=30 height=30 src=/assets/img/rss.svg    alt="rss feed"                ></a>
      <li><a href=https://jxck.io/humans.txt><amp-img width=30 height=30 src=/assets/img/humans.svg alt="huamns.txt"              ></a>
      <li><a href=https://jxck.io           ><amp-img width=30 height=30 src=/assets/img/jxck.svg   alt="jxck logo" class=logo    ></a>
    </ul>
  </nav>
</header>
<main>
  <dl class=info>
    <div><dt>created_at</dt><dd><time class=created_at datetime=2016-04-09>2016-04-09</time></dd></div>
    <div><dt>updated_at</dt><dd><time class=updated_at datetime=2020-12-18>2020-12-18</time></dd></div>
    <div>
        <dt>tags</dt>
        <dd>
          <nav class=tags>
            <ul>
              <li><a href="/tags/hpkp.html">hpkp</a>
              <li><a href="/tags/security.html">security</a>
            </ul>
          </nav>
        </dd>
    </div>
    <div>
      <dt>toc</dt>
      <dd>
        <details class=info>
          <summary>headdings</summary>
          <nav>
            <ul>
              <li><a href=#intro>## Intro</a>
              <li><a href=#public-key-pinning>## Public Key Pinning</a>
              <li><a href=#æ¦‚è¦>### æ¦‚è¦</a>
              <li><a href=#public-key-pinning-for-http>### Public Key Pinning for HTTP</a>
              <li><a href=#preload-public-key-pinning>### Preload Public Key Pinning</a>
              <li><a href=#hpkp-ã®è¨­å®š>## HPKP ã®è¨­å®š</a>
              <li><a href=#public-key-pins-ãƒ˜ãƒƒãƒ€>### Public-Key-Pins ãƒ˜ãƒƒãƒ€</a>
              <li><a href=#subject-public-key-information-spki>### Subject Public Key Information (SPKI)</a>
              <li><a href=#report-uriio>## report-uri.io</a>
              <li><a href=#æ‡¸å¿µç‚¹>## æ‡¸å¿µç‚¹</a>
              <li><a href=#è¨¼æ˜æ›¸æ›´æ–°ã¨-max-age>### è¨¼æ˜æ›¸æ›´æ–°ã¨ Max-Age</a>
              <li><a href=#ä¸­é–“è¨¼æ˜æ›¸ã®-pin>### ä¸­é–“è¨¼æ˜æ›¸ã® Pin</a>
              <li><a href=#æœ¬ã‚µã‚¤ãƒˆã¸ã®é©ç”¨>## æœ¬ã‚µã‚¤ãƒˆã¸ã®é©ç”¨</a>
              <li><a href=#pin>### Pin</a>
              <li><a href=#çµæœ>### çµæœ</a>
            </ul>
          </nav>
        </details>
      </dd>
    </div>
  </dl>
  <article>
    <h1><a href=/entries/2016-04-09/public-key-pinning.html>Public Key Pinning for HTTP(HPKP) å¯¾å¿œã¨ report-uri.io ã§ã®ãƒ¬ãƒãƒ¼ãƒˆåé›†</a></h1>
    <section>
      <h2 id="intro"><a href="#intro">Intro</a></h2>
      <p>æœ¬ã‚µã‚¤ãƒˆã«ã¦ Public Key Pinning for HTTP ã‚’æœ‰åŠ¹åŒ–ã—ãŸã€‚
      <p><a href="https://blog.jxck.io/entries/2016-03-30/content-security-policy.html">CSP</a> åŒæ§˜ã€ã¾ãšã¯ Report-Only ã‚’è¨­å®šã—ã€
      <p>HPKP Report ã«ã¤ã„ã¦ã‚‚ã€ <a href="https://report-uri.io">report-uri.io</a> ã‚’ç”¨ã„ã¦åé›†ã™ã‚‹ã“ã¨ã«ã—ãŸã€‚
      <p>å°å…¥ã«å¿…è¦ãªè¨­å®šã‚„ã€æ³¨æ„ç‚¹ã«ã¤ã„ã¦ã¾ã¨ã‚ã‚‹ã€‚
      <p>ãªãŠã€æœ¬ã‚µã‚¤ãƒˆã¸ã®å°å…¥ã¯ã‚ãã¾ã§ <em>å®Ÿé¨“</em> ã§ã‚ã‚‹ã€‚é‹ç”¨ã‚„å½±éŸ¿ã‚‚è¸ã¾ãˆã‚‹ã¨ã€ä¸€èˆ¬ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®å®‰æ˜“ãªå°å…¥ã¯æ¨å¥¨ã—ãªã„ã€‚
      <p>ã¾ãŸã€æœ¬æ¥ã¯ HSTS ã¨ä½µç”¨ã™ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¦ã„ã‚‹ã€‚(å¿…é ˆã§ã¯ãªã„)
      <p>ãã¡ã‚‰ã‚‚è¿½ã£ã¦å¯¾å¿œã™ã‚‹äºˆå®šã§ã‚ã‚‹ã€‚
    </section>
    <section>
      <h2 id="public-key-pinning"><a href="#public-key-pinning">Public Key Pinning</a></h2>
      <section>
        <h3 id="æ¦‚è¦"><a href="#æ¦‚è¦">æ¦‚è¦</a></h3>
        <p>Public Key Pinning for HTTP(HPKP) ã¨ã¯ã€è¨¼æ˜æ›¸ã®ä¿¡é ¼æ€§ã‚’å‘ä¸Šã•ã›ã‚‹ä»•çµ„ã¿ã§ã‚ã‚‹ã€‚
        <ul>
          <li><a href="https://tools.ietf.org/html/rfc7469">RFC 7469 - Public Key Pinning Extension for HTTP</a>
        </ul>
        <p>æœ¬ã‚µã‚¤ãƒˆã¯ HTTPS ã‚’æä¾›ã—ã¦ãŠã‚Šã€è¨¼æ˜æ›¸ã¯è¨¼æ˜æ©Ÿé–¢(CA)ã‚ˆã‚Šæœ‰æ–™ã®ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰è¨¼æ˜æ›¸ã‚’è³¼å…¥ã—ã¦è¨­å®šã—ã¦ã„ã‚‹ã€‚(Let&rsquo;s Encrypt ã§ã¯ãªã„)
        <p>æœ¬ãƒ‰ãƒ¡ã‚¤ãƒ³ã®è¨¼æ˜æ›¸ã®æœ‰åŠ¹æ€§ã¯ã€ã“ã® CA ã«ã‚ˆã£ã¦æ‹…ä¿ã•ã‚Œã¦ãŠã‚Šã€ã“ã® CA ã®ä¿¡é ¼æ€§ã¯å„ãƒ‡ãƒã‚¤ã‚¹ã«ãƒ—ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸ CA ã®è¨¼æ˜æ›¸(ãŠã‚ˆã³ãã“ã¾ã§ã®ãƒã‚§ã‚¤ãƒ³)ã§æ‹…ä¿ã•ã‚Œã¦ã„ã‚‹ã€‚
        <p>ã“ã®ä»•çµ„ã¿(PKI) ã¯ã€ãƒ‡ãƒã‚¤ã‚¹ãŒ CA ã‚’ä¿¡ç”¨ã—ã¦ã„ã‚‹ã“ã¨ãŒåœŸå°ã¨ãªã£ã¦ã„ã‚‹ãŸã‚ã€ä¾‹ãˆã° CA ãŒå±æ®†åŒ–ã™ã‚‹ãªã©ã®ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆãŒç™ºç”Ÿã™ã‚‹ã¨ã€åŸºç›¤ãã®ã‚‚ã®ãŒæºã‚‰ãã“ã¨ã‚’æ„å‘³ã™ã‚‹ã€‚
        <p>ã‚‚ã— CA ãŒæ”»æ’ƒã•ã‚Œã€å½ã®è¨¼æ˜æ›¸ãŒç™ºè¡Œã•ã‚ŒãŸå ´åˆã€ãƒ¦ãƒ¼ã‚¶ã¯ãã®è¨¼æ˜æ›¸ãŒ CA ã‹ã‚‰ç™ºè¡Œã•ã‚ŒãŸæœ¬ç‰©ã«ã—ã‹è¦‹ãˆãªã„ãŸã‚ã€æ¥ç¶šå…ˆãŒå½ã‚µã‚¤ãƒˆã ã¨ã—ã¦ã‚‚ä¿¡ç”¨ã—ã¦ã—ã¾ã†ã€‚
        <p>ä»•çµ„ã¿ä¸Š CA ã®å±æ®†åŒ–ã¯ã‚ã£ã¦ã¯ãªã‚‰ãªã„è¨³ã ãŒã€è¨¼æ˜æ›¸ã®ä¾¡å€¤ãŒé«˜ã¾ã‚Šã¤ã¤ã‚ã‚Šã€ä¸€æ–¹ã§å¤šãã®èªè¨¼å±€ãŒé‹ç”¨ã•ã‚Œã¦ã„ã‚‹ä»Šã€ä¸€éƒ¨ã® CA ã§ã¯å®Ÿéš›ã«æ”»æ’ƒã«ã‚ˆã‚‹å½ã®è¨¼æ˜æ›¸ç™ºè¡ŒãŒç™ºç”Ÿã—ã¦ã„ã‚‹ã€‚
        <ul>
          <li>
            <a href="https://jp.globalsign.com/blog/2013/certificate_public_key_pinning.html">Pinning å¹´è¡¨</a> å‚ç…§
          </li>
          <li>
            <a href="http://d.hatena.ne.jp/jovi0608/20140902/1409635279">1. ä¸æ­£ãª SSL è¨¼æ˜æ›¸ã®è„…å¨</a> å‚ç…§
          </li>
        </ul>
        <p>ãã“ã§ã€ã“ã®ãƒªã‚¹ã‚¯ã‚’ä½æ¸›ã™ã‚‹ãŸã‚ã«è€ƒæ¡ˆã•ã‚ŒãŸã®ãŒ HPKP ã§ã‚ã‚‹ã€‚
      </section>
      <section>
        <h3 id="public-key-pinning-for-http"><a href="#public-key-pinning-for-http">Public Key Pinning for HTTP</a></h3>
        <p>æœ¬ã‚µã‚¤ãƒˆ <code translate="no">jxck.io</code> ã®è¨¼æ˜æ›¸ã«ã¤ã„ã¦ã¯ã€ç®¡ç†è€…ã§ã‚ã‚‹ç­†è€…ãŒæŠŠæ¡ã—ã¦ã„ã‚‹ã€‚
        <p>ã“ã®è¨¼æ˜æ›¸ã®ãƒãƒƒã‚·ãƒ¥ã‚’ HTTP ãƒ˜ãƒƒãƒ€ã«ä»˜ä¸ã™ã‚‹ã“ã¨ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã›ã‚‹ã€‚
        <p>ãƒ¦ãƒ¼ã‚¶ãŒ HTTPS æ¥ç¶šã‚’ç¢ºç«‹ã™ã‚‹éš›ã«ã€å–å¾—ã—ãŸè¨¼æ˜æ›¸ã®ãƒãƒƒã‚·ãƒ¥ã¨ã€ã“ã®ãƒ˜ãƒƒãƒ€ã®ãƒãƒƒã‚·ãƒ¥ã‚’æ¯”è¼ƒã™ã‚‹ã“ã¨ã§ã€ã‚µãƒ¼ãƒã®æç¤ºã—ãŸè¨¼æ˜æ›¸ãŒç­†è€…ã®æŠŠæ¡ã—ã¦ã„ã‚‹è¨¼æ˜æ›¸ã¨åŒã˜ã§ã‚ã‚‹ã“ã¨ã‚’æ¤œæŸ»ã™ã‚‹ã€‚
        <p>å½ç‰©ãŒæ¤œå‡ºã•ã‚ŒãŸéš›ã¯ã€ä¸æ­£ãªè¨¼æ˜æ›¸ãŒç™ºè¡Œã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã‚¢ã‚¯ã‚»ã‚¹ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹ã€‚
        <p>å®Ÿéš›ã« HPKP ã§é•åãŒç™ºç”Ÿã—ãŸå ´åˆã®æŒ™å‹•ã¯ä»¥ä¸‹ã§è©¦ã™ã“ã¨ãŒã§ãã‚‹ã€‚
        <p><a href="https://pinningtest.appspot.com/">pinningtest.appspot.com</a>
        <p>ã¾ãŸã€é•åã‚’ç™ºè¦‹ã—ãŸå ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ãã®æ—¨ã‚’ãƒ¬ãƒãƒ¼ãƒˆã¨ã—ã¦ç”Ÿæˆã—ã€é€ä¿¡ã™ã‚‹ã“ã¨ã§ç®¡ç†è€…ã«é€šçŸ¥ã™ã‚‹ã€‚
        <p>ã“ã‚Œã«ã‚ˆã£ã¦ã€ç­†è€…ã¯è‡ªåˆ†ã®ã‚µãƒ¼ãƒ“ã‚¹ã®è¨¼æ˜æ›¸ãŒå½é€ ã•ã‚Œã¦ã„ã‚‹äº‹å®Ÿã‚’æŠŠæ¡ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚
        <p>ã“ã®ä»•çµ„ã¿ã¯ã€è¿‘å¹´ç™ºç”Ÿã—ã¦ã„ã‚‹ CA ã¸ã®æ”»æ’ƒã«ã‚ˆã‚‹å½è¨¼æ˜æ›¸ã®ç™ºè¡Œã®ç™ºè¦‹ã«ã€å¤§ããè²¢çŒ®ã—ã¦ã„ã‚‹ã€‚
      </section>
      <section>
        <h3 id="preload-public-key-pinning"><a href="#preload-public-key-pinning">Preload Public Key Pinning</a></h3>
        <p>HTTP ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ã§ãƒãƒƒã‚·ãƒ¥ã‚’æç¤ºã™ã‚‹æ–¹æ³•ã§ã¯ã€ æœ€åˆã®ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã‹ã‚‰å½ã®è¨¼æ˜æ›¸ãŒä½¿ã‚ã‚Œã¦ã„ãŸå ´åˆã¯ç„¡åŠ›ã§ã‚ã‚‹ã€‚
        <p>ã‚ãã¾ã§ã€å†è¨ªå•æ™‚ã¸ã®å½é€ ã«ã—ã‹åŠ¹æœãŒãªãã€ã“ã‚Œã‚’ <em>Trust on First Use (TOFU)</em> ã¨ã„ã†ã€‚
        <p>ãã“ã§ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚ã‚‰ã‹ã˜ã‚è¨¼æ˜æ›¸ã®ãƒãƒƒã‚·ãƒ¥ã‚’ç™»éŒ²ã™ã‚‹ Preload Publick Key Pinning ã‚‚ã‚ã‚‹ã€‚
        <p>ãŸã ã—ã€ã“ã‚Œã¯éå¸¸ã«é‡è¦ãªãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã®ã¿æä¾›ã•ã‚Œã¦ãŠã‚Šã€ç¾çŠ¶ä¸€èˆ¬ã«å‘ã‘ãŸç™»éŒ²ãƒ•ãƒ­ãƒ¼ã¯å…¬é–‹ã•ã‚Œã¦ã„ãªã„ã€‚
        <p>Chrome ã¨ Firefox ã¸ã® Preload Pins ã®ãƒªã‚¹ãƒˆã¯ä»¥ä¸‹ã§ã‚ã‚‹ã€‚
        <ul>
          <li><a href="https://src.chromium.org/viewvc/chrome/trunk/src/net/http/transport_security_state_static.json">[chrome] Contents of /trunk/src/net/http/transport_security_state_static.json</a>
          <li><a href="https://mxr.mozilla.org/mozilla-central/source/security/manager/tools/PreloadedHPKPins.json">mozilla-central mozilla/security/manager/tools/PreloadedHPKPins.json</a>
        </ul>
        <p>ã—ãŸãŒã£ã¦æœ¬ã‚µã‚¤ãƒˆã§ã¯ã€ HTTP ãƒ˜ãƒƒãƒ€ã§ã®å¯¾å¿œã‚’å®Ÿæ–½ã™ã‚‹ã€‚
      </section>
    </section>
    <section>
      <h2 id="hpkp-ã®è¨­å®š"><a href="#hpkp-ã®è¨­å®š">HPKP ã®è¨­å®š</a></h2>
      <section>
        <h3 id="public-key-pins-ãƒ˜ãƒƒãƒ€"><a href="#public-key-pins-ãƒ˜ãƒƒãƒ€">Public-Key-Pins ãƒ˜ãƒƒãƒ€</a></h3>
        <p>HPKP ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã«ã¯ã€ Public-Key-Pins ãƒ˜ãƒƒãƒ€ã‚’ä»˜ä¸ã—ã€ãã®å¼•æ•°ã«ãƒãƒƒã‚·ãƒ¥ã‚’æŒ‡å®šã™ã‚‹ã€‚
        <pre class=http><code translate="no">Public-Key-Pins: pin-sha256=&quot;base64==&quot;; max-age=expireTime [; includeSubdomains][; report-uri=&quot;reportURI&quot;]</code></pre>
        <p>è¨­å®šã«ã¤ã„ã¦ã¯ã€ä»¥ä¸‹ãŒå‚è€ƒã«ãªã‚‹ã€‚
        <p><a href="https://developer.mozilla.org/ja/docs/Web/Security/Public_Key_Pinning">Public Key Pinning - Web ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | MDN</a>
        <p>åŸºæœ¬çš„ã«ã¯å¾Œè¿°ã™ã‚‹æ–¹æ³•ã§å–å¾—ã—ãŸè¨¼æ˜æ›¸ã®ãƒãƒƒã‚·ãƒ¥ã§ã‚ã‚‹ Subject Public Key Information(SPKI) ã® Base64 ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿æŒã™ã‚‹æœŸé™ã€æ¤œè¨¼ã«å¤±æ•—ã—ãŸå ´åˆã®ãƒ¬ãƒãƒ¼ãƒˆé€ä¿¡å…ˆã‚’æŒ‡å®šã™ã‚‹ã€‚
        <p>ç¾æ™‚ç‚¹ã§ã¯ sha256 ã®ã¿ãŒã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¨ã—ã¦èªã‚ã‚‰ã‚Œã¦ã„ã‚‹ãŒã€ã“ã‚Œã¯å°†æ¥æ‹¡å¼µã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚
        <p>Pin ã‚’è¨­å®šã™ã‚‹éš›ã¯ã€ç¾åœ¨æœ‰åŠ¹ãª Pin ä»¥å¤–ã«ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— Pin ã®ç™»éŒ²ãŒå¿…é ˆã«ãªã£ã¦ã„ã‚‹ã€‚
        <p>ã“ã‚Œã¯ã€æœ‰åŠ¹ãª Pin ã‚’ä¸€ã¤ã—ã‹ç™»éŒ²ã—ãªã„å ´åˆã€è¨¼æ˜æ›¸ã®å±æ®†åŒ–ã‚„æœŸé™åˆ‡ã‚Œãªã©ã§ã€è¨¼æ˜æ›¸ã‚’æ–°ã—ãæ›´æ–°ã™ã‚‹ã¨å¿…ãšä¸ä¸€è‡´ãŒèµ·ã“ã£ã¦ã—ã¾ã†ãŸã‚ã§ã‚ã‚‹ã€‚
      </section>
      <section>
        <h3 id="subject-public-key-information-spki"><a href="#subject-public-key-information-spki">Subject Public Key Information (SPKI)</a></h3>
        <p>Pin ã®å€¤ã¯ openssl ã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã‚Œã°ã€å…¬é–‹éµã‹ã‚‰ SPKI ã® Base64 ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã¾ã§ä¸€æ‹¬ã§è¡Œãˆã‚‹ã€‚
        <p>æ‰‹å…ƒã«ã€ Key, CSR, CRT ã®ã„ãšã‚Œã‹ãŒã‚ã‚Œã°ãã‚Œã‚’ç”¨ã„ã‚‹ã“ã¨ãŒã§ãã€ Web çµŒç”±ã§å–å¾—ã—ãŸå…¬é–‹éµã‹ã‚‰ã‚‚ç”Ÿæˆã§ãã‚‹ã€‚
        <p>ç®¡ç†è€…ãŒãƒ­ãƒ¼ã‚«ãƒ«ã§è¡Œã†ãªã‚‰ã€ä½•ã‹ã‚ã£ã¦ã‚‚ä¸€ç•ªå®³ã®ãªã„ CSR ã‹ã‚‰ã®ç”ŸæˆãŒã‚ˆã•ãã†ã¨è€ƒãˆã‚‹ã€‚
        <pre class=sh><code translate="no">$ openssl req -in my-signing-request.csr -pubkey -noout | openssl rsa -pubin -outform der | openssl dgst -sha256 -binary | openssl enc -base64</code></pre>
      </section>
    </section>
    <section>
      <h2 id="report-uriio"><a href="#report-uriio">report-uri.io</a></h2>
      <p>ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã€  Pin ã«ä¸€è‡´ã—ãªã„è¨¼æ˜æ›¸ã‚’æ¤œå‡ºã—ãŸå ´åˆã€é•åãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã— <code translate="no">report-uri</code> ã«æŒ‡å®šã—ãŸ URI ã«å¯¾ã—ã¦è‡ªå‹•çš„ã«é€ä¿¡ã™ã‚‹ã€‚
      <p>HPKP ã®é•åãƒ¬ãƒãƒ¼ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ãª JSON ãƒ‡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚
      <pre class=json><code translate="no">{
    &quot;date-time&quot;: &quot;2014-04-06T13:00:50Z&quot;,
    &quot;hostname&quot;: &quot;www.example.com&quot;,
    &quot;port&quot;: 443,
    &quot;effective-expiration-date&quot;: &quot;2014-05-01T12:40:50Z&quot;,
    &quot;include-subdomains&quot;: false,
    &quot;served-certificate-chain&quot;: [
      &quot;-----BEGIN CERTIFICATE-----\n
      MIIEBDCCAuygAwIBAgIDAjppMA0GCSqGSIb3DQEBBQUAMEIxCzAJBgNVBAYTAlVT\n
      ...
      HFa9llF7b1cq26KqltyMdMKVvvBulRP/F/A8rLIQjcxz++iPAsbw+zOzlTvjwsto\n
      WHPbqCRiOwY1nQ2pM714A5AuTHhdUDqB1O6gyHA43LL5Z/qHQF1hwFGPa4NrzQU6\n
      yuGnBXj8ytqU0CwIPX4WecigUCAkVDNx\n
      -----END CERTIFICATE-----&quot;,
      ...
    ],
    &quot;validated-certificate-chain&quot;: [
      &quot;-----BEGIN CERTIFICATE-----\n
      MIIEBDCCAuygAwIBAgIDAjppMA0GCSqGSIb3DQEBBQUAMEIxCzAJBgNVBAYTAlVT\n
      ...
      HFa9llF7b1cq26KqltyMdMKVvvBulRP/F/A8rLIQjcxz++iPAsbw+zOzlTvjwsto\n
      WHPbqCRiOwY1nQ2pM714A5AuTHhdUDqB1O6gyHA43LL5Z/qHQF1hwFGPa4NrzQU6\n
      yuGnBXj8ytqU0CwIPX4WecigUCAkVDNx\n
      -----END CERTIFICATE-----&quot;,
      ...
    ],
    &quot;known-pins&quot;: [
      &quot;pin-sha256=\&quot;d6qzRu9zOECb90Uez27xWltNsj0e1Md7GkYYkVoZWmM=\&quot;&quot;,
      &quot;pin-sha256=\&quot;E9CZ9INDbd+2eRQozYqqbQ2yXLVKB9+xcprMF+44U1g=\&quot;&quot;
    ]
  }</code></pre>
    </section>
    <section>
      <h2 id="æ‡¸å¿µç‚¹"><a href="#æ‡¸å¿µç‚¹">æ‡¸å¿µç‚¹</a></h2>
      <section>
        <h3 id="è¨¼æ˜æ›¸æ›´æ–°ã¨-max-age"><a href="#è¨¼æ˜æ›¸æ›´æ–°ã¨-max-age">è¨¼æ˜æ›¸æ›´æ–°ã¨ Max-Age</a></h3>
        <p>HPKP ã®é‹ç”¨ã§ã®ä¸€ç•ªã®æ‡¸å¿µã¯ã€è¨¼æ˜æ›¸ã®æ›´æ–°ã ã‚ã†ã€‚
        <p>ä¾‹ãˆã°ä»Šå›ã¯ã€ç¾è¡Œã® Pin(Pin1 ã¨ã™ã‚‹)ã«åŠ ãˆã¦ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— Pin(Pin2 ã¨ã™ã‚‹) ã‚’ä¸€ã¤ç™»éŒ²ã—ãŸãŸã‚ã€ã“ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— Pin2 ã«ã‚ãŸã‚‹è¨¼æ˜æ›¸ã¸ã®æ›´æ–°ã¾ã§ã¯å•é¡Œãªã„ã ã‚ã†ã€‚
        <p>ã—ã‹ã—ã€å•é¡Œã¯ãã®ã‚ã¨ã©ã†ã™ã‚‹ã‹ã§ã‚ã‚‹ã€‚(ãã®å¾Œæ›´æ–°ã™ã‚‹æ–°ã—ã„è¨¼æ˜æ›¸ã® Pin ã‚’ Pin3, 4&hellip; ã¨ã™ã‚‹)
        <p>ãƒ–ãƒ©ã‚¦ã‚¶ãŒ <code translate="no">[Pin1, Pin2]</code> ã‚’ä¿å­˜ã—ãŸçŠ¶æ…‹ãªã‚‰ã€ Pin2 ã®è¨¼æ˜æ›¸ã«æ›´æ–°ã•ã‚Œã¦ã‚‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒåŠ¹ã„ã¦ã„ã‚‹ãŸã‚å•é¡Œã¯ãªã„ã€‚
        <p>æ¬¡ã«è¨¼æ˜æ›¸ã‚’ Pin3 ã®ã‚‚ã®ã¸æ›´æ–°ã—ãŸæ™‚ãŒãƒã‚¤ãƒ³ãƒˆã¨ãªã‚‹ã ã‚ã†ã€‚
        <p>ã“ã‚Œã¯ <code translate="no">[Pin1, Pin2]</code> ã‚’ä¿å­˜ã—ãŸã¾ã¾ã€ãã®å¾Œã—ã°ã‚‰ãè¨ªã‚Œãšã€ Pin3 ã®è¨¼æ˜æ›¸ã«æ›´æ–°ã•ã‚Œã¦ã‹ã‚‰è¨ªã‚ŒãŸã‚‰ã€æŒã£ã¦ã„ã‚‹ Pin ã¨è¨¼æ˜æ›¸ãŒãƒãƒƒãƒã›ãšæ¥ç¶šã§ããªããªã‚‹ãŸã‚ã§ã‚ã‚‹ã€‚
        <p>ã¤ã¾ã‚Šã€ Pin3 ã‚’é‹ç”¨ã™ã‚‹éš›ã«ã¯ã€å¿…ãš <code translate="no">[Pin1, Pin2]</code> ã®çµ„ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ Expire ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚
        <p>ã—ã‹ã—ã€ãã‚Œã‚’æã‚Œã¦ Pin ã® Max-Age ã‚’çŸ­ãã—ã™ãã‚‹ã¨ã€ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã³ã« Pin ãŒç„¡åŠ¹ã«ãªçŠ¶æ…‹ã¨ãªã‚Šã€ TOFU ã§ã‚ã‚‹ã“ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’ç”Ÿã‹ã—ãã‚Œãªã„ã€‚
        <p>Report-Only ã§ãªã„é‹ç”¨ã§ã¯ã€æ¥ç¶šãŒã§ããªã„ã¨ã„ã†çŠ¶æ…‹ã«ãªã‚‹ãŸã‚ã€ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®å½±éŸ¿ã‚‚å¤§ãããªã‚‹ã€‚
        <p>ãã‚Œã‚’è¸ã¾ãˆã¦ã‹ã€ä»¥ä¸‹ã®ã‚ˆã†ãªä¸­é–“è¨¼æ˜æ›¸ã‚’ Pin ç•™ã‚ã™ã‚‹ã¨ã„ã†é‹ç”¨ã‚‚ã‚ã‚‹ã‚ˆã†ãªã®ã§ã€ç´¹ä»‹ã™ã‚‹ã€‚
      </section>
      <section>
        <h3 id="ä¸­é–“è¨¼æ˜æ›¸ã®-pin"><a href="#ä¸­é–“è¨¼æ˜æ›¸ã®-pin">ä¸­é–“è¨¼æ˜æ›¸ã® Pin</a></h3>
        <p>Github ã¯ç¾åœ¨ HPKP ã‚’é‹ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ Pin ã®å€¤ã‚’èª¿ã¹ã¦ã¿ãŸã€‚
        <p>Github ã§ã¯ã€ Leaf (<code translate="no">github.com</code> è‡ªä½“ã®è¨¼æ˜æ›¸) ã§ã¯ãªãã€ãã“ã‹ã‚‰ Root CA ã¾ã§ã®è¨¼æ˜æ›¸ãƒã‚§ã‚¤ãƒ³ã«å…¥ã£ã¦ã„ã‚‹ã€ä¸­é–“è¨¼æ˜æ›¸ã‚’ Pin ã¨ã—ã¦è¨­å®šã—ã¦ã„ãŸã€‚
        <p>OpenSSL ã® <code translate="no">-showcerts</code> ã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨ã„ã¦ã€ Github ã®è¨¼æ˜æ›¸ã‚’å–å¾—ã— Pin ã‚’è¨ˆç®—ã—ã¦ã¿ã‚‹ã€‚
        <p>(è¨¼æ˜æ›¸ãŒäºŒã¤è¦‹ã‚ã‚Šã€ä¸­é–“è¨¼æ˜æ›¸ã«ã‚ãŸã‚‹äºŒã¤ç›®ã ã‘æŠœãå‡ºã—ã¦ã„ã‚‹)
        <pre class=sh><code translate="no"># github.com pins Intermediate Certificate
# so add `-showcerts` option for first openssl
# and extract second CERTIFICATE with ruby
echo &#39;---- EXPECTED ----&#39;
openssl s_client -servername github.com -connect github.com:443 -showcerts 2&gt;/dev/null \
  | ruby -nle &#39;puts $_.scan(/-----BEGIN CERTIFICATE-----.*?-----END CERTIFICATE-----/m)[1]&#39; \
  | openssl x509 -pubkey -noout 2&gt;/dev/null \
  | openssl rsa -pubin -outform der 2&gt;/dev/null \
  | openssl dgst -sha256 -binary 2&gt;/dev/null \
  | openssl enc -base64 2&gt;/dev/null</code></pre>
        <p>å®Ÿéš›ã« <code translate="no">Public-Key-Pins</code> ãƒ˜ãƒƒãƒ€ã‚’è¦‹ã¦ã¿ã‚‹ã€‚ã“ã®ä¸­ã«ã¯ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å«ã‚ã„ãã¤ã‹ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãŒã€ãã®ä¸­ã«ä¸Šã§è¨ˆç®—ã—ãŸã‚‚ã®ãŒå…¥ã£ã¦ã„ã‚‹ã€‚
        <pre class=sh><code translate="no"># get the actual Public-Key-Pins header
# this will include hash calculated above
echo &#39;---- ACTUAL ----&#39;
curl -sI https://github.com | grep Public-Key-Pins | ruby -nle &#39;puts $_.gsub(&quot;;&quot;, &quot;\n&quot;)&#39;</code></pre>
        <p>Leaf ã®è¨¼æ˜æ›¸ã‚’ Pin ç•™ã‚ã—ã¦ã—ã¾ã†ã¨ã€å‰è¿°ã®é€šã‚Šè¨¼æ˜æ›¸ã®æ›´æ–°ã§ Pin ã¨ã®ä¸æ•´åˆãŒèµ·ããŸå ´åˆã«ã€æ¥ç¶šã§ããªããªã£ã¦ã—ã¾ã†ã€‚
        <p>ã“ã®ãƒªã‚¹ã‚¯ã‚’æ¸›ã‚‰ã™ãŸã‚ã«ã€ä¸­é–“è¨¼æ˜æ›¸ã‚’ Pin ç•™ã‚ã™ã‚‹ã¨ã„ã†é‹ç”¨ã«ãªã£ã¦ã„ã‚‹æ¨¡æ§˜ã§ã‚ã‚‹ã€‚
        <p>(<a href="https://twitter.com/jovi0608">@jovi0608</a> ã•ã‚“ã«ã‚¢ãƒ‰ãƒã‚¤ã‚¹é ‚ãã¾ã—ãŸã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚)
      </section>
    </section>
    <section>
      <h2 id="æœ¬ã‚µã‚¤ãƒˆã¸ã®é©ç”¨"><a href="#æœ¬ã‚µã‚¤ãƒˆã¸ã®é©ç”¨">æœ¬ã‚µã‚¤ãƒˆã¸ã®é©ç”¨</a></h2>
      <section>
        <h3 id="pin"><a href="#pin">Pin</a></h3>
        <p>ã¾ãšç¾åœ¨ã®è¨¼æ˜æ›¸ã‹ã‚‰ã€ç¾è¡Œã® Pin ã‚’ç”Ÿæˆã—ãã‚Œã‚’æŒ‡å®šã™ã‚‹ã€‚
        <p>æœ¬ã‚µã‚¤ãƒˆã§ã¯ã€ 2 å¹´ã”ã¨ã«æ›´æ–°ã™ã‚‹ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰è¨¼æ˜æ›¸ã‚’è³¼å…¥ã—ã¦ä½¿ç”¨ã—ã¦ã„ã‚‹ã€‚
        <p>ã¤ã¾ã‚Šã€å…¨ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã§è¨¼æ˜æ›¸ã¯ä¸€ã¤ã§ã‚ã‚Šã€æœŸé™ã‚‚é•·ã„ã®ã§ã€é‹ç”¨ã¯ãã“ã¾ã§é›£ã—ããªã„ã ã‚ã†ã¨è€ƒãˆã¦ã„ã‚‹ã€‚
        <p>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— Pin ã¨ã—ã¦ã¯ã€æœªæ¥ã®(æ¬¡ã®æ›´æ–°ã§ä½¿ç”¨ã™ã‚‹)è¨¼æ˜æ›¸ç”¨ã®éµã‚’å…ˆã«ä¸€ã¤ç”¨æ„ã—ã¦ãŠãã€ãã“ã‹ã‚‰ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç”¨ Pin ã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã«ã—ãŸã€‚
        <p><code translate="no">report-uri</code> ã«ã¯ CSP åŒæ§˜ <a href="https://report-uri.io">report-uri.io</a> ã‚’è¨­å®šã™ã‚‹ã€‚
        <p>ãã—ã¦ã“ã‚Œã‚’ <a href="https://jxck.io">jxck.io</a> ã¨ <a href="https://blog.jxck.io">blog.jxck.io</a> ã«è¨­å®šã—ãŸã€‚
        <p>ä»Šå›ã¯ã‚ãã¾ã§å®Ÿé¨“ã§ã‚ã‚‹ãŸã‚ã€ CSP åŒæ§˜ã« Report-Only ã§ã®é‹ç”¨ã¨ã™ã‚‹ã€‚
        <p>ãƒ‡ãƒ¢ã¨ã—ã¦ã€ Report-Only ç„¡ã—ã®ãƒ˜ãƒƒãƒ€ã‚’æŒ‡å®šã—ãŸãƒšãƒ¼ã‚¸ã‚’ä»¥ä¸‹ã«ç”¨æ„ã—ãŸã€‚
        <p><a href="https://labs.jxck.io/public-key-pinning/">Public Key Pinning DEMO | labs.jxck.io</a>
        <p>HPKP ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã¯ã€ chrome://net-internals/#hsts ã§ç¢ºèªã§ãã‚‹ã€‚ã—ã‹ã— Report-Only ã§ã¯ã“ã“ã«ä¸ŠãŒã‚‰ãªã„ã‚ˆã†ã§ã‚ã‚‹ã€‚
      </section>
      <section>
        <h3 id="çµæœ"><a href="#çµæœ">çµæœ</a></h3>
        <p>ç”Ÿæˆã—ãŸãƒ˜ãƒƒãƒ€ã¯ä»¥ä¸‹ã§ã‚ã‚‹ã€‚
        <p>max-age ã¯ã€ã¨ã‚Šã‚ãˆãš 3600s ã¨çŸ­ã„å€¤ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ã«ã—ãŸã€‚
        <pre class=http><code translate="no">Public-Key-Pins:
  max-age=3600;
  pin-sha256=&quot;7JT7NhX2St/VBBkRi4BO427M7ytLy7p3CRYPtHpSm7c=&quot;;
  pin-sha256=&quot;+WpRHNpAId2FIOvVgwmS3HsG+eJtERKC4/qM1tQaeRk=&quot;;
  report-uri=&quot;https://4887c342aec2b444c655987aa8b0d5cb.report-uri.io/r/default/hpkp/enforce&quot;</code></pre>
        <p>Report-Only ã¯ã€ <code translate="no">max-age</code> ãŒä¸è¦ã«ãªã‚‹ã€‚ã¾ãŸ report-uri.io ã§ã¯ã€ Report-Only ç”¨ã« URI ãŒå¤‰ã‚ã‚‹ã®ã§ã€ãã‚Œã‚’è¨­å®šã—ã¦ã„ã‚‹ã€‚
        <pre class=http><code translate="no">Public-Key-Pins-Report-Only:
  pin-sha256=&quot;7JT7NhX2St/VBBkRi4BO427M7ytLy7p3CRYPtHpSm7c=&quot;;
  pin-sha256=&quot;+WpRHNpAId2FIOvVgwmS3HsG+eJtERKC4/qM1tQaeRk=&quot;;
  report-uri=&quot;https://4887c342aec2b444c655987aa8b0d5cb.report-uri.io/r/default/hpkp/reportOnly&quot;</code></pre>
        <p>æ„å›³çš„ã«ãƒ¬ãƒãƒ¼ãƒˆã‚’ä¸Šã’ã¦è¦‹ã¦ã¿ãŸã‹ã£ãŸãŒã€å˜ã«ä¸æ­£ãªè¨¼æ˜æ›¸ã‚’ç”¨æ„ã™ã‚‹ã ã‘ã§ã¯ã ã‚ã ã£ãŸã€‚
        <p>ã©ã†ã‚„ã£ãŸã‚‰ã€æ­£ã—ã HPKP é•åãŒã§ãã‚‹ã®ã‹ã€è‡ªå‰ã§ CA ã‚’ç«‹ã¦ã‚‹ãªã©ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã‹ã‚‚ã—ã‚Œãªã„ã€‚
        <p>ã¨ã„ã†ã“ã¨ã§ CSP ã¨é•ã„ã€ã‚ˆã»ã©ã®ã“ã¨ãŒãªã„é™ã‚Šãƒ¬ãƒãƒ¼ãƒˆã¯ä¸ŠãŒã‚‰ãªã„ã¯ãšã§ã‚ã‚‹ã¨è€ƒãˆã‚‹ã€‚
        <p>ã‚‚ã—ãƒ¬ãƒãƒ¼ãƒˆãŒä¸ŠãŒã£ãŸå ´åˆã€çµæ§‹ãªå•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦è¿½è¨˜ã‚„å ±å‘Šã‚’ã—ãŸã„ã€‚
      </section>
    </section>
  </article>
</main>
<hr>
<footer>
  <p class=copyright><small>Copyright &copy; 2016 <a href=/>Jxck</a>. All Rights Reserved.</small> See <small><a href=/policies/site.html>Site Policy</a> and <a href=/policies/privacy.html>Privacy Policy</a>.</small></p>
  <amp-ad width=100vw height=320 type=adsense data-ad-client=ca-pub-2902784829138215 data-ad-slot=9735419796 data-auto-format=rspv data-full-width><div overflow></div></amp-ad>
</footer>
</body>
</html>
<amp-analytics type=googleanalytics id=analytics1>
<script type="application/json">
{
  "vars": {
    "account": "UA-15088753-7"
  },
  "triggers": {
    "trackPageview": {
      "on": "visible",
      "request": "pageview"
    }
  }
}
</script>
</amp-analytics>