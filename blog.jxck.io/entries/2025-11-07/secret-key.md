# [1password][security] Secret Key の運用とアカウントリカバリ #3

## Intro

このエントリは、組織において 1Password Business を運用する上での考慮点を解説する。

- 1Password Business 運用ガイド素案 - Google ドキュメント
  - https://docs.google.com/document/d/1CZ5xdOz2IRHXRKVzcUZG-d4wQmlexBet8_Iee_EJlmw/edit?tab=t.0#heading=h.tt9z21tir3fm

ここまで 1Password における Master Password について解説してきた。

記憶に頼る Master Password と異なり、Secret Key は実質的に所有の要素となる。

本エントリでは、この Secret Key の扱いについて解説する。


## Secret Key

Secret Key は、新しいデバイスでログインする際に必要な値だ。通常は、既にログイン済みのデバイスで表示し、転記すれば良い。転記する作業は、QR コードの表示によって代替することもできる。

つまり、Secret Key は、ログイン済みのデバイスが全て無くなった状態、つまりリカバリ時にこそ必要となる。

わかりやすいのは、災害などで持ち物を全て失った際だろう。このとき、Secret Key を何かしらの方法でバックアップから取得できなければ、アカウントはロストすることになる。1Password のヘルプに問い合わせても教えてもらうことはできない。


## Emergency Kit

アカウントを作成した際、1Password からは Emergency Kit という PDF が発行される。これは実質的に Secret Key が記載されたファイルだ。

![Emergency Kit](emergency-kit.png#290x280)

Emergency Kit には、Master Password を書き込む欄もあり、印刷して保存するように推奨されている。

しかし、Master Password と Secret Key が両方記載された Emergency Kit は、それだけで 1Password にログインできる情報になるため、書き込むことにはリスクがある。

Master Password は記憶にのみ留めるという前提が成り立っている以上、仮に Emergency Kit が紛失や盗難に遭ってもそれだけでログインできないように、Secret Key だけの状態にしておく方が良いだろう。

ログイン URL やメールアドレスも、普段から使っていれば忘れないだろうと考えると、Emergency Kit 自体にこだわる必要はなく、*Secret Key の値をいかに管理するか* が重要となる。

この保管方法は、*個人アカウントかビジネスアカウントかで異なる* のだ。


## 個人アカウントでの Secret Key 管理

個人アカウントは、自分自身が管理者という立ち位置になる。もし Secret Key を失っても、助けてくれる人は自分以外にいない。

したがって、Secret Key をどう管理するかは、非常に重要な問題であり、自己責任でそれを行う必要がある。

基本的には、「自分が被災して全てを失っても、なんとか取り戻せるようにバックアップを考える」ことになり、これはちゃんと考えると難しい問題だ。

それについては、個人的にずっと取り組んでおり、別エントリにまとめているため、そちらに譲る。

- "Less Password" 時代のアカウント防災訓練 | blog.jxck.io
  - https://blog.jxck.io/entries/2025-01-27/account-recovery.html

なお、Secret Key の値は更新することが可能だ。物理的に保管を考える場合は、逆に Secret Key を更新しないように気をつける必要もある。

しかし、ビジネスアカウントを持っていると、ここも少し楽になるため、話は変わる。


## ビジネスアカウントでの Secret Key 管理

組織のアカウントにメンバーとして参加している場合は、何かあっても管理者によってリカバリができる。管理者がリカバリを実施すると、そのアカウントのメールに再設定のリンクが送られ、Master Password を再設定すれば、同じメールアドレスのアカウントに再度ログインできる。

つまり、Secret Key どころか、Master Password を忘れてしまっても、管理者に問い合わせる方法さえあれば、アカウントはリカバリできるのだ。

また、リカバリ時は Secret Key は新しくなるため、リカバリを前提にフローを考えるなら、現在の Secret Key を物理的に保管する運用とは相性が悪くなる。

したがって、メンバーは Secret Key を保管せず、リカバリが必要なときだけ管理者に依頼するという運用を取るのが、最も安全性が高いと言えるだろう。したがって、Emergency Kit のように雑に管理されるとリスクになるものは、最初から発行しないように設定することができる。

![Emergency Kit は発行しない](no-emergency-kit.png#489x146)

そこで、ビジネスアカウントでは、メンバーには以下のような運用をさせる。

- 新しくログインする場合は、ログイン済みの 1Password で Secret Key を確認する
- Secret Key は 1Password で確認し、そこ以外に保管しない
- Emergency Kit も発行しない
- ログインできなくなったら、管理者にリカバリを依頼する


## ビジネスアカウントの管理者の Secret Key 管理

ところが、管理者はそうはいかない。管理者が Secret Key を失っても、リカバリをしてくれる人がいないからだ。

管理者が一人で、そのアカウントをロストすると、組織全体の管理ができなくなる。したがって、まずは管理グループに複数の管理者を追加し、誰かがロストしても他の管理者がリカバリできるように多重化しておく必要がある。

もちろん、同じオフィスで被災して全員がアカウントをロストする可能性などもあるため、各管理者の Secret Key の物理保管も考えておくべきだろう。

企業の場合は、個人よりディザスタリカバリに取りうる選択肢が多いだろう。

- 会社だけでなく、各管理者が自宅にも保管する
- 会社にある金庫などを利用する
- 拠点が複数ある場合は、拠点ごとに分散する
- 貸金庫などを借りていれば、そこに保存する
- etc

とにかく、同時に全部をロストしないように工夫をすればよい。


## ビジネスアカウントへの個人アカウントのバックアップ

個人アカウントは自分が管理者なので、リカバリに頼れない。

しかし、ビジネスアカウントは、リカバリに頼れる。

そこを利用して、「個人アカウントの Secret Key だけを、ビジネスアカウント側にも保存しておく」という運用は、個人アカウントのロストリスクを大幅に下げることができる。

前述した、筆者の個人的な工夫は、自分以外に頼れるものがない前提で設計していたが、ビジネスアカウントに入ることで、一気に頼れる人が増えることになるのだ。

おそらく、企業では「ビジネスアカウントには、私物のアイテムは保存しない」といったルールが設けられるだろう。しかし、この一点だけは例外を認めることで、社員の個人アカウントのリカバリ方法を増やすことができるため、ルールを設ける立場にある人は、ぜひこの例外を認めてあげるとよいだろう。

ただし、「ビジネスアカウントの Secret Key を、私物アカウントに保存する」は、必要ない点に注意。