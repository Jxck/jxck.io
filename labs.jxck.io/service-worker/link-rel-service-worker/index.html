<!DOCTYPE html>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">

<meta http-equiv="origin-trial" data-feature="Foreign Fetch" data-expires="2017-01-16" content="Ai32KiE0NsOIRPR/NxvUwEpcM4hYyo6RPRvkG8liNEIXP4DW6furrliZkqCqZh/ug83oAcdctA12PEh3ymNUZg0AAABneyJvcmlnaW4iOiAiaHR0cHM6Ly9qeGNrLmlvOjQ0MyIsICJpc1N1YmRvbWFpbiI6IHRydWUsICJmZWF0dXJlIjogIkZvcmVpZ25GZXRjaCIsICJleHBpcnkiOiAxNDg0NTgyMTg2fQ==">

<title>Link rel=Service Worker DEMO | labs.jxck.io</title>

<h1><strong><a href=https://www.chromestatus.com/feature/5682681044008960>Link rel=serviceworker (deprecated)</a></strong></h1>

<p>button in this page is for fetching <strong>random value</strong> from <a href=./random>./random</a> API
<p>API serves with <code>Link: rel=serviceworker</code> header and register service worker for offline support
<p>so make this page offline via devtools, you can fetch random value from service worker fallback

<p>random: <span id=random></span></p>
<button id=button>fetch</button>

<script>
'use strict';
const $  = document.querySelector.bind(document)
const $$ = document.querySelectorAll.bind(document)
EventTarget.prototype.on = EventTarget.prototype.addEventListener

document.on('DOMContentLoaded', async (e) => {
  console.log(e)

  $('#button').on('click', async () => {
    const res  = await fetch('./random')
    const text = await res.text()
    console.log(text)
    $('#random').textContent = text
  })
  $('#button').dispatchEvent(new Event('click'));
})
</script>
