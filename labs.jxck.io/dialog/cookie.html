<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cookie Dialog DEMO | labs.jxck.io</title>

<h1>Cookie Dialog DEMO</h1>

<style>
  :root {
    font-family: sans-serif;
  }

  dialog {
    width: 20vw;
    position: absolute;
    inset-: auto;
    right: 1%;
    bottom: 1%;
    left: auto;

    margin: 0;
    padding: 2rem;

    border: solid 1px #ccc;
    border-radius: 2%;
  
    /** open animation */
    &[open] {
      opacity: 1;
      display: block;
      transition: opacity 0.2s, display 0.2s allow-discrete;
      @starting-style {
        opacity: 0;
      }
    }

    /** close animation */
    &:not([open]) {
      opacity: 0;
      display: none;
      transition: opacity 0.2s, display 0.2s allow-discrete;
    }

    &::backdrop {
      background-color: rgba(0, 0, 0, 0.5)
    }

    section {
      display: flex;
      flex-direction: column;
      gap: 1rem;

      h1, p {
        margin: 0;
      }

      form[method=dialog] {
        display: flex;
        justify-content: flex-end;
        gap: 1rem;
      }
    }
  }
</style>
<dialog aria-labelledby="dialog-label">
  <section>
    <h1 id="dialog-label">Cookie Notice</h1>
    <p>We use some essential cookies to make this website work.</p>
    <p>We'd like to bra bra bra bra bra bra bra bra bra bra bra bra bra.</p>
    <p>We also use cookies set by other sites to help us bra bra bra bra bra bra bra bra bra bra bra bra bra bra.</p>
    <form method="dialog">
      <button type="close" autofocus>Reject Cookies</button>
      <button type="submit">Accpet Cookies</button>
    </form>
  </section>
</dialog>
<button id="showModal">dialog.showModal()</button>

<script>
  const $ = document.querySelector.bind(document)
  const $$ = document.querySelectorAll.bind(document)
  EventTarget.prototype.on = EventTarget.prototype.addEventListener

  $("dialog").show()

  $("#showModal").on("click", (e) => {
    $("dialog").show()
  })

  $("form").on("submit", (e) => {
    e.preventDefault()
    const data = new FormData(e.target)
    console.log(new Map(data))
    const params = new URLSearchParams(data)
    $("dialog").close(params)
  })

  $("dialog").on("close", (e) => {
    console.log(e)
    console.log(e.type, e.target.returnValue)
  })

  $("dialog").on("cancel", (e) => {
    console.log(e)
    console.log(e.type, e.target.returnValue)
  });

</script>